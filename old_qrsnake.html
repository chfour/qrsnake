<style>body{background-color:#000}canvas{background-color:#000;border:2px solid #fff}.bG{display:inline-grid;grid-template-columns:auto auto auto auto;grid-template-areas:". u . x" "l d r .";background-color:#202020}.bGI{background-color:#000;color:#fff;width:80px;height:80px;font-size:24pt;touch-action:manipulation}</style><canvas width=630 height=665>h</canvas><br><div class=bG><button class=bGI style=grid-area:u onclick="kQ.push('w')">&uarr;</button>
<button id=rb class=bGI style=grid-area:x onclick="kQ.push('r')">R</button>
<button class=bGI style=grid-area:l onclick="kQ.push('a')">&larr;</button>
<button class=bGI style=grid-area:d onclick="kQ.push('s')">&darr;</button>
<button class=bGI style=grid-area:r onclick="kQ.push('d')">&rarr;</button></div><script>let ce=document.querySelector("canvas"),c=ce.getContext("2d"),pxS,bRS=document.querySelector("#rb");D=(x,y)=>{c.fillRect(x*pxS,y*pxS,pxS,pxS)}
bR=()=>{return(Math.random()*(29-0+1))<<0}
let pS,pX,pY,bX,bY,kQ=[],gS=-2,pD,pP,tx;document.addEventListener("keydown",(e)=>{kQ.push(e.key);});setInterval(()=>{pxS=Math.floor(ce.width/30);if(gS==0){switch(kQ.shift()){case "w":if(pD!=1)pD=0;break;case "s":if(pD!=0)pD=1;break;case "a":if(pD!=3)pD=2;break;case "d":if(pD!=2)pD=3;break;}
switch(pD){case 0:pY-=1;break;case 1:pY+=1;break;case 2:pX-=1;break;case 3:pX+=1;break;}
if(pX>29)pX=0;if(pY>29)pY=0;if(pX<0)pX=29;if(pY<0)pY=29;if(pX==bX&&pY==bY){bX=bR();bY=bR();pP++;}else{pS.pop();}
pS.unshift([pX,pY]);tx="Score: "+pP;bRS.disabled=true;if(pS.slice(1).filter(s=>s[0]==pX&&s[1]==pY).length>0)gS=-1;}else if(gS==-2){pS=[[22,18],[23,18]];pX=22;pY=18;bX=10;bY=13;gS=0;pD=2;pP=0;tx="";}else if(gS==-1){tx="Game Over! Score: "+pP;bRS.disabled=false;if(kQ.pop()=="r")gS=-2;}
if(gS!=-2){c.clearRect(0,0,ce.width,ce.height);c.fillStyle="#F00";D(bX,bY);c.fillStyle="#FFF";c.font="30px sans-serif";c.fillText(tx,0,ce.height-5);for(s of pS)D(s[0],s[1]);}},300);</script>
